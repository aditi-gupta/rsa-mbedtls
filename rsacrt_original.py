from fractions import gcd
import binascii

def solve_private_keys(e, s, m, n):
	p = gcd(pow(s, e)-m,n)
	q = n//p
	private_keys = [hex(p), hex(q)]
	return private_keys

d = int("491D4B2EB44E803A2314827E2A6B647E32EF7336C5CD798634961ADE3D1CF2CB15F4DF084406F8FEB7444309BE4FA0698EEE6C9D0B835FE9BA92480B06A07604952D003A405C09130EC73F177FB28B96D5AD0850AD840D4B296E7D696E7E182CF2E113A74E20FA2A1AFD8698C40B63153FA0F894C742F249683A74F7B50B963EB6B0E48DD10CC8E33B0A3061689F6411398FF8899AE7925E9C653E57CCC256884C37E739D98BFE365177BB573216F3C388742082889237D339806BA5FBC503A6B5C317FD54D7D86086277DD70342F383AAF3BB571070FC49F258B2F5511B555C54F932115556C3423B4CA4674BF06A994487DCCA44B586658EE1C0A32B115479", 16)
p = int("F5D2772FA3DA0B5AB6A0DEE2897983D6EB0EB9B63A94860EAD14271669C2DDEB089569971093DBBDC46C7E230709FE1BE1967051FB6113F4D836CF792AE3893E487851C500F022E942E2C91FF5BC391E5401F2C41CFE9744AA76048578CC1FEB59B0B705834EE672CE7AE53B06D78831A3701BB58A0746C3B492D8B7DCDDB133", 16)
q = int("B5544FFA117E94D9CA58FF9DB5CBA8E498D4B8192CA578C2D4E1D8828B0329EDE2CA737BBBB3AC25DD11DF04EBE1971D25B0AC3C73D26018A3C52381A520EACEF826ACBA73EBB5EA3569872FEBEC53C6B188FA6DD3B8343C22652C4A5CF2FC34EBCEA888037DBEDA22C55076A15AE1A8827F620AA64A775021851B0BF2808CC9", 16)
dp = int("9E73DFA7B1B267073E194C12321345CC4F0FDADD7FBD24FC68CC48B5C5CE7A4579EEF5750E96805A3E36C0C7CB4DC1A22F334D8B4AC2349EEA8FCA048C84C67E83302B651549B4F72ECA0862B57F7241FE5C93239E9CECDCB21408AE1043637FCCFC7FBCE9FAFDC89B17D492CBC23A63E4B9EAE285EA52CEEBA28C5757E2FEC9", 16)
dq = int("55CF6E81A2E1CA433EB4DB52A1039E0B801FBA777F5F5744AC45AC962A7EF6CAB2B6A7EBF829D0DFA23CA0D3CD64D6845E9FBB0268B537F0B11FCBEBC05F517F5C83C0DE03999A5F19A3B4EC02B3B5F9A36E7544A01ADDED4F419DB21B4689FFE94FC50588D16B0E03C2688F9B504CD5D7DBBC63D9CA07A88E14557653EE6DB1", 16)
qInv = int("722a9b8b4ef96c281ad70007045836053c8b25148846cc735e0610ad166287bc4e59e35c55d68ca04996f84be96732388f81a4c8813913d0f770b9c93e5fe7a1d51662ed4daaf2f19f4450a685d024886a7420b94ee98038f8baecc376b77d73c23b3fa9b4e714bbe12e976b46e30dfcd83f27c5d431346e5318dcecd96a12ef", 16)
m = int("0001ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff003031300d0609608648016503040201050004207e6bb673f061cfd23cba009e648143fb07ac77dcd1681f6a9af9d5fe7c0f7f4b", 16)
e = int("010001", 16)
n = int("AE1EC41FDD978C18CB43F9587F9B85DF804603100611497DCB445D157E44E717C78D53FAC3644DEA302645F6CFF852A785C3DAEA525BE01A4B1960D6512D97C677436ED17D03A55DDD8E41D737456C2B1512D533806EB048C5570269CBDFABB5E335821CE69C892A825A3896FC46990A8F6FECC759DAD9D6FD76BBF55BAA34B0789CACE898B6CC8CDBB50A0BFE7073A31DAF0B67845F76B71D42942B03FC02D6D68789C6CEF502C39AA0FB392E5E84BD1581E7295BDF6C45463FEA20A5220413381B82A72F95B1BB29AC6E833B70EB5B9F9D43B4D56A94ECBD02C1CBC8C8EED903485BD2A379A8B81B8FE20216EE6019A5F19656A483CCD9C23EB3B17678050B", 16)

# print m
# print dp
# print p

s1 = pow(m, dp, p)
s2 = pow(m, dq, q)
print "s1 = " + str(hex(s1))
print "s2 = " + str(hex(s2))

s = (s1 - s2) * (qInv) % p
s = s2 + s*q

verify = pow(s, e, n)
print "verify = " + str(hex(verify))

print "s = " + str(hex(s))


# print solve_private_keys(e, s, m, n)
